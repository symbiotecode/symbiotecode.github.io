<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Tablets vs Corpses (AI Clay Edition)</title>

<!--
  TRANSLATOR'S NOTE:
  This code was divinely hallucinated by an AI pretending to be
  a Late Bronze Age Canaanite scribe who absolutely does not
  understand event loops but is very confident anyway.
-->

<style>
  body {
    background: #2b1d0e;
    color: #f5deb3;
    font-family: "Papyrus", serif; /* historical accuracy died here */
    text-align: center;
  }

  h1 {
    color: #d4af37;
  }

  #tablet {
    width: 600px;
    margin: auto;
    background: #5a3b1e;
    border: 4px groove #000;
  }

  .row {
    display: flex;
    height: 80px;
    border-top: 1px solid #000;
  }

  .cell {
    flex: 1;
    border-right: 1px solid #000;
    position: relative;
    cursor: pointer;
  }

  .plant {
    width: 50px;
    height: 50px;
    background: #228b22;
    border-radius: 50%;
    margin: auto;
    margin-top: 15px;
  }

  .zombie {
    width: 40px;
    height: 60px;
    background: #6b4f2a;
    position: absolute;
    top: 10px;
    right: 0;
  }

  .seed {
    width: 10px;
    height: 10px;
    background: #adff2f;
    border-radius: 50%;
    position: absolute;
  }

  #inscription {
    font-size: 12px;
    opacity: 0.8;
    margin-top: 8px;
  }
</style>
</head>
<body>

<h1>Tablets vs Corpses</h1>
<p>
  Recorded in the year “this makes no sense”<br>
  Transcribed by an AI who skimmed Wikipedia
</p>

<div id="tablet"></div>

<div id="inscription">
  The dead advance. The scribe forgot difficulty scaling.
</div>

<script>
/*
  SCRIBE'S PREFACE:
  I, an administrative worker of the city-state,
  have been cursed with knowledge of JavaScript.
  I do not know why things move every 50 heartbeats,
  but the gods demand it.
*/

const ROWS = 5;
const COLS = 9;

const tablet = document.getElementById("tablet");
let fields = [];
let invaders = [];
let seeds = [];

// carve the grid, as one carves tablets
for (let r = 0; r < ROWS; r++) {
  const row = document.createElement("div");
  row.className = "row";
  fields[r] = [];

  for (let c = 0; c < COLS; c++) {
    const cell = document.createElement("div");
    cell.className = "cell";

    cell.onclick = () => {
      if (!fields[r][c]) {
        const plant = document.createElement("div");
        plant.className = "plant";
        cell.appendChild(plant);

        fields[r][c] = {
          plant,
          cooldown: 0 // number chosen via divination
        };
      }
    };

    row.appendChild(cell);
    fields[r][c] = null;
  }

  tablet.appendChild(row);
}

// summon the restless dead (poorly)
setInterval(() => {
  const row = Math.floor(Math.random() * ROWS);
  const corpse = document.createElement("div");
  corpse.className = "zombie";

  tablet.children[row].appendChild(corpse);

  invaders.push({
    el: corpse,
    row,
    distance: 0,
    vitality: 3 // tablets say 3, do not question tablets
  });
}, 3000);

// main ritual loop
setInterval(() => {

  // plants cast seeds because agriculture
  for (let r = 0; r < ROWS; r++) {
    for (let c = 0; c < COLS; c++) {
      const plot = fields[r][c];
      if (plot) {
        plot.cooldown++;

        if (plot.cooldown > 45) {
          plot.cooldown = 0;

          const seed = document.createElement("div");
          seed.className = "seed";
          seed.style.left = (c * 66 + 40) + "px";
          seed.style.top = (r * 80 + 35) + "px";

          document.body.appendChild(seed);

          seeds.push({
            el: seed,
            row: r,
            x: c * 66 + 40
          });
        }
      }
    }
  }

  // seeds travel eastward, as trade does
  seeds.forEach((seed, si) => {
    seed.x += 5;
    seed.el.style.left = seed.x + "px";

    invaders.forEach((invader, ii) => {
      if (invader.row === seed.row) {
        const ix = tablet.offsetLeft + 600 - invader.distance - 40;

        if (Math.abs(seed.x - ix) < 10) {
          invader.vitality--;
          seed.el.remove();
          seeds.splice(si, 1);

          if (invader.vitality <= 0) {
            invader.el.remove();
            invaders.splice(ii, 1);
          }
        }
      }
    });

    if (seed.x > window.innerWidth) {
      seed.el.remove();
      seeds.splice(si, 1);
    }
  });

  // corpses shamble forward with historical inevitability
  invaders.forEach(invader => {
    invader.distance += 1;
    invader.el.style.right = invader.distance + "px";

    if (invader.distance > 600) {
      document.getElementById("inscription").innerText =
        "The city has fallen. The scribe blames fate, not bugs.";
    }
  });

}, 50);

/*
  COLOPHON:
  If this were balanced, it would be heresy.
  If this were clean code, it would be modern.
*/

</script>

</body>
</html>
